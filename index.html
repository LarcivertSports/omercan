<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”¥ RGFootball Ultimate Video Ä°ndirici v2.0</title>
    <style>
        /* Mevcut stil + yeni geliÅŸtirmeler */
        body { font-family: 'Segoe UI', sans-serif; max-width: 900px; margin: 30px auto; padding: 20px; background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%); color: #fff; }
        .tool-container { background: rgba(42,42,74,0.9); padding: 40px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.6); backdrop-filter: blur(20px); }
        .status-bar { background: #333; padding: 10px; border-radius: 10px; margin: 20px 0; font-weight: bold; }
        .advanced-toggle { background: #ff6b6b; margin-bottom: 20px; }
        .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        .bulk-download { background: linear-gradient(45deg, #00d2d3, #4facfe); margin-top: 20px; }
        @media (max-width: 768px) { .video-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="tool-container">
        <h1>âš½ RGFootball ULTIMATE Video Ä°ndirici v2.0</h1>
        <p><strong>Forum, topic ve tÃ¼m videolarÄ± otomatik bulur & indirir!</strong></p>
        
        <input type="url" id="urlInput" placeholder="http://rgfootball.net/viewforum.php?f=87 veya topic linki..." />
        <button class="advanced-toggle" onclick="toggleAdvanced()">âš™ï¸ GeliÅŸmiÅŸ Ayarlar</button>
        
        <div id="advancedOptions" style="display:none; margin: 20px 0; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 10px;">
            <label><input type="checkbox" id="deepScan" checked> Derin Tarama (M3U8/MP4)</label><br>
            <label><input type="checkbox" id="streamHosts"> Streamtape/Mixdrop</label><br>
            <label><input type="checkbox" id="bbcode"> BBCode Videolar</label>
        </div>
        
        <button onclick="extractVideos()" style="background: linear-gradient(45deg, #4facfe, #00f2fe);">ğŸ” TÃœM VÄ°DEOLARI BUL</button>
        
        <div class="status-bar" id="statusBar" style="display:none;"></div>
        <div class="spinner" id="spinner"></div>
        <div class="results" id="results"></div>
        
        <button class="bulk-download" onclick="bulkDownload()" id="bulkBtn" style="display:none;">ğŸ“¦ HEPSÄ°NÄ° Ä°NDÄ°R</button>
    </div>

    <script>
        let allVideos = [];
        
        // GeliÅŸtirilmiÅŸ extractVideos fonksiyonu
        async function extractVideos() {
            const url = document.getElementById('urlInput').value;
            if (!url.includes('rgfootball.net')) return alert('âŒ RGFootball linki girin!');
            
            const statusBar = document.getElementById('statusBar');
            statusBar.textContent = 'ğŸ” Sayfa analiz ediliyor...';
            statusBar.style.display = 'block';
            
            // MULTIPLE PROXY fallback
            const proxies = [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://thingproxy.freeboard.io/fetch/'
            ];
            
            let html = '';
            for (let proxy of proxies) {
                try {
                    const response = await fetch(proxy + encodeURIComponent(url));
                    html = await response.text();
                    break;
                } catch(e) {
                    continue;
                }
            }
            
            if (!html) throw new Error('Proxy hatasÄ±');
            
            const doc = new DOMParser().parseFromString(html, 'text/html');
            const videos = [];
            
            // SUPER GÃœÃ‡LÃœ VIDEO DETECTOR
            const deepScan = document.getElementById('deepScan').checked;
            const streamScan = document.getElementById('streamHosts').checked;
            const bbcodeScan = document.getElementById('bbcode').checked;
            
            // 1. M3U8 + MP4 (EN Ã–NEMLÄ°)
            if (deepScan) {
                const m3u8s = Array.from(html.match(/https?:\/\/[^"\s]+\.m3u8[^"\s]*/gi) || []);
                const mp4s = Array.from(html.match(/https?:\/\/[^"\s]+\.mp4[^"\s]*/gi) || []);
                [...m3u8s, ...mp4s].forEach(url => {
                    if (!allVideos.some(v => v.url === url)) {
                        allVideos.push({url, type: 'direct', quality: url.includes('1080') ? '1080p' : '720p'});
                    }
                });
            }
            
            // 2. Iframe videolar
            doc.querySelectorAll('iframe').forEach(iframe => {
                const src = iframe.src;
                if (src && (src.includes('youtube') || src.includes('vimeo') || src.includes('dailymotion'))) {
                    if (!allVideos.some(v => v.url === src)) {
                        allVideos.push({url: src, type: 'iframe', title: 'YouTube/Vimeo'});
                    }
                }
            });
            
            // 3. Stream hostlar
            if (streamScan) {
                const hosts = ['streamtape.com', 'mixdrop.co', 'dood', 'upstream', 'ok.ru', 'vk.com'];
                doc.querySelectorAll('a[href]').forEach(a => {
                    hosts.forEach(host => {
                        if (a.href.includes(host) && !allVideos.some(v => v.url === a.href)) {
                            allVideos.push({url: a.href, type: 'stream', host});
                        }
                    });
                });
            }
            
            // 4. BBCode + gizli linkler
            if (bbcodeScan) {
                const bbMatches = html.match(/\[video[^\]]*]([^[]+?)\[\/video\]/gi) || [];
                bbMatches.forEach(match => {
                    const urlMatch = match.match(/https?:\/\/[^\s\]]+/);
                    if (urlMatch && !allVideos.some(v => v.url === urlMatch[0])) {
                        allVideos.push({url: urlMatch[0], type: 'bbcode'});
                    }
                });
            }
            
            statusBar.textContent = `âœ… ${allVideos.length} video bulundu!`;
            document.getElementById('bulkBtn').style.display = allVideos.length ? 'block' : 'none';
            displayResults(allVideos);
        }
        
        function displayResults(videos) {
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.innerHTML = `
                <h3>ğŸ‰ ${videos.length} Video Bulundu!</h3>
                <div class="video-grid">
                    ${videos.map((v, i) => `
                        <div class="video-item">
                            <strong>${i+1}.</strong> ${v.title || v.host || v.quality || 'Video'}
                            <br><small>${v.url.substring(0, 60)}...</small>
                            <br>
                            <button class="download-btn" onclick="smartDownload('${v.url}', '${v.type}')">
                                ğŸ“¥ ${v.type.toUpperCase()}
                            </button>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // AKILLI Ä°NDÄ°RME
        function smartDownload(url, type) {
            if (type === 'direct') {
                downloadFile(url, 'video_' + Date.now() + '.mp4');
            } else if (type === 'iframe' && url.includes('youtube')) {
                const ytId = url.split('v=')[1]?.split('&')[0] || url.split('/embed/')[1]?.split('?')[0];
                window.open(`https://www.y2mate.com/youtube/${ytId}`, '_blank');
            } else {
                window.open(url, '_blank');
            }
        }
        
        function bulkDownload() {
            allVideos.forEach((video, i) => {
                setTimeout(() => smartDownload(video.url, video.type), i * 1000);
            });
        }
        
        function downloadFile(url, filename) {
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
        
        function toggleAdvanced() {
            const adv = document.getElementById('advancedOptions');
            adv.style.display = adv.style.display === 'none' ? 'block' : 'none';
        }
        
        // Otomatik Ã§alÄ±ÅŸtÄ±r
        document.getElementById('urlInput').addEventListener('keypress', e => e.key === 'Enter' && extractVideos());
    </script>
</body>
</html>
